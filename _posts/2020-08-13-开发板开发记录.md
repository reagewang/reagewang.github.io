---
layout: post
title: "开发板开发操作记录"
tags: [3559a]
comments: true
---

# 配置NFS使虚拟机与开发板共享目录
## 搭建NTFS 环境
```
sudo apt-get install nfs-kernel-server
sudo apt-get install nfs-common
```
## 添加共享目录
```
sudo gedit /etc/export
添加
/home/xxx/nfs *(rw,sync,no_root_squash,no_subtree_check)
```
## 使得上面nfs目录设置生效
```
sudo exportfs -rf
```
## 重启nfs服务
```
sudo /etc/init.d/rpcbind restart
sudo /etc/init.d/nfs-kernel-server restart
或
sudo service nfs-kernel-server restart
```
## 验证是否成功
```
showmount –e
```
## 开发板上电之后挂载目录
```
mount -t nfs -o nolock -o tcp 192.168.102.58:/home/xxx/nfs /mnt/nfs
192.168.102.58是虚拟机IP地址,必须与开发板的eth0处于同一个网段
/home/xxx/nfs是虚拟机上的共享目录
/mnt/nfs:是开发板上共享目录
```

# 开发板串口设置参数
```
调试串口的设置参数为：
波特率：115200
停止位：1
数据位：8
无校验
```
# SecureCRT下的串口不能输入
用secureCRT建了一个串口COM1后，连接上开发板后，可以正确接受和显示串口的输出，但是按键输入无效。解决方法：Session Options -> Connection -> Serial -> Flow Control，将原先默认选中的 RTS/CTS取消掉，再重新connect开发板，再次连上后，此时就可以从键盘输入了。

# 开发板上电之后第一次直接配置网口IP地址和掩码
```
ifconfig eth0 192.168.1.22 netmask 255.255.255.0
此设置每次重启、开机后都得改。
```
# 开发板网络不工作
ifconfig 命令没有显示出网络设备列表，不能对网络进行配置
运行 
```
ip link set up dev eth0 
```
命令解决问题
# 开发板把网络配置写入rcS文件
```
sudo gedit /etc/init.d/rcS
添加
ifconfig eth0 192.168.1.22 netmask 255.255.255.0 up
route add default gw 192.168.1.1    
ifconfig lo 127.0.0.1   
```
# 开发板空间不足
```
/home # df -h
Filesystem                Size      Used Available Use% Mounted on
/dev/root                15.0M      8.9M      6.1M  59% /
devtmpfs                239.8M      4.0K    239.8M   0% /dev

/home # ls /dev
是否存在mmcblk0p1 mmcblk0p2,如果存在则

/home # mount /dev/mmcblk0p2 /home
```
# 运行测试程序之前记得加载驱动
```
在ko目录执行
./load3559av100_multicore -i
```
# 运行测试程序之前导入库文件目录
```
export LD_LIBRARY_PATH="/home/lib:$LD_LIBRARY_PATH"
```
# 开发板调试运行sample_vio测试程序步骤
1. 板子上电
2. 挂载NTFS 网络文件系统
```
mount -t nfs -o nolock -o tcp -o rsize=32768,wsize=32768 192.168.102.58:/home/wh/hi3559a /mnt
```
3. 加载驱动
```
/mnt/Hi3559AV100_SDK_V2.0.1.0/mpp/out/linux/multi-core/ko # ./load3559av100_multicore -i -sensor0 imx334 -sensor1 imx334
```
4. 运行程序
```
/mnt/Hi3559AV100_SDK_V2.0.1.0/mpp/sample/vio # ./sample_vio 4
```
5. 查看HDMI 信息命令
```
cat hdmi0_sink
```
# 虚拟机中解压sdk包错误,执行 ./sdk.unpack出现下面的问题
```
./sdk.unpack: ECHO: not found
```
1. 原因是Ubuntu中的shell问题，默认是指向dash而不是bash，如果使用linux其他的发行版本，则可以执行
```
ls -l /bin/sh
```
查看
2. 解决办法:修改Ubuntu默认的shell，在终端中执行命令
```
sudo dpkg-reconfigure dash
选<no>
```
3. 重新执行./sdk.unpack解决问题
# 虚拟机中qtcreator通过cmake编译代码报错
```
error: undefined reference to `__cxa_begin_catch'
```
解决方法:CMakelists.text里面target_link_libraries加入libstdc++.so

# Source Insight 4 中文乱码的解决办法
## 单个文件乱码解决办法：
菜单栏中【File】 > 【Reload As Encoding...】 > 【Chinese Simplified (GB18030)】 > 选择后，点击load，问题解决！！！
## 所有文件乱码解决办法：
我的理解，在做下面操作的时候关闭所有工程或文件，等设置完后，再把工程或文件加载进来

菜单栏中 【Options】 > 【Preferences】 >File标签中，最下面的“Default encod­ing” ：改成System Default(Windows ANSI)或者Chinese Simplified(GB2312) CP:936，点击确定，问题解决

# QtCreator加入cmake
1. 下载CMake并解压 
下载地址:https://cmake.org/download/
```
tar xvf cmake-3.12.0-rc3.tar.gz
```
2. 编译并安装CMake
```
$ cd cmake-3.12.0-rc3/
$ ./bootstrap
$ make -j8
$ sudo make install
```
```
编译错误
Could NOT find OpenSSL, try to set the path to OpenSSL root folder in the system variable OPENSSL_ROOT_DIR (missing: OPENSSL_LIBRARIES OPENSSL_INCLUDE_DIR) 
在 Ubuntu 系统上的解决方法是，在命令行输入如下命令：sudo apt-get install libssl-dev
```
3. 配置Qt
```
Qt-->Tools-->Options-->Build & Run-->CMake-->Add
Name：随意，暂取cmake-3.12.0-rc3
Path：/home/yong/Downloads/cmake-3.12.0-rc3/bin/cmake，即编译出来的CMake命令的绝对路径。
Qt->Tools->Options->Build & Run->Kits->Desktop(dafault)->CMake Tool 选择 cmake-3.12.0-rc3
```
# wget通过ftp下载文件到开发板
```
wget ftp://用户名:密码@服务器IP/文件名
```
# ftpput上传文件到虚拟机
```
ftpput -u 用户名 -p 密码 服务器IP地址 文件名
```
